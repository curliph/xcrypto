
\label{sec:feature-sets}

The Crypto ISE is split into a base feature set, and several optional
features which can be included only if the implementation needs them.
This is done because while some of the instructions are useful across a
broad range of cryptographic kernels, some are more specific, and are only
relevant to certain algorithms or primitives.

Software can determine which features of the ISE are implemented by
interrogating the {\tt CISEF} register detailed in section
\ref{sec:csr-mccr}.

All of the optional features within the ISE can be emulated using the
base RISC-V ISE and the Crypto ISE.

\subsection{Base Features}

The base features present in all implementations of the Crypto ISE are:
\begin{itemize}
\item The {\em move} instructions listed in section
    \ref{sec:move-instructions}.
\item The memory access instructions listed in section
    \ref{sec:memory-instructions}, {\em excluding all scatter and gather
    variants}.
\item All {\em bitwise} instructions listed in section
    \ref{sec:bitwise-instructions}.
\item All {\em packed field} instructions listed in section
    \ref{sec:packed-field-instructions}.
\end{itemize}

\subsection{Packed Arithmetic Widths}

By default, the packed arithmetic width instructions detailed in
section \ref{sec:packed-arithmetic-instructions} support operations on
packed bit-fields of widths $2$, $4$, $8$, $16$ and $32$.

For extremely resource constrained or application specific implementations,
some unnecessary pack widths (as defined by the implementer) may be omitted.

Supported pack widths are indicated by the {\tt pX} bits of the
\nameref{sec:csr-mccr}.

Packed arithmetic instructions operating on supported pack widths are
executed as normal. If a packed arithmetic instruction operating on an
unsupported pack width is encountered, the implementation should raise an
{\em Illegal Instruction} exception.

\subsection{Randomness}

Implementations can optionally implement the Crypto ISE randomness interface
instructions {\tt RSEED.cr} and {\tt RSAMP.cr}.

The inclusion of these instructions in an implementation is indicated by the
{\tt R} bit of the \nameref{sec:csr-mccr}.

If the random interface instructions are not implemented, then their opcodes
will cause the implementation to raise an {\em Illegal Instruction}
exception.

\subsection{Scatter/Gather}

The {\tt SCATTER} and {\tt GATHER} byte/halfword instructions described
in section \ref{sec:scatter-gather} may be omitted to reduce implementation
complexity.

The inclusion of these instructions in an implementation is indicated by the
{\tt SG} bit of the \nameref{sec:csr-mccr}.

An implementation must support all variants of {\tt SCATTER} and {\tt GATHER}
or none.

If {\tt SCATTER} and {\tt GATHER} instructions are not implemented, then their
opcodes will cause the implementation to raise an {\em Illegal Instruction}
exception.

\subsection{Multi-precision Arithmetic}

All of the multi-precision arithmetic instructions listed in section
\ref{sec:multi-precision-instructions} may be optionally included or omitted
as a group.

Inclusion of the multi-precision arithmetic instructions is indicated by
the {\tt MP} bit of the  \nameref{sec:csr-mccr}.

If the multi-precision arithmetic instructions are not implemented, then their
opcodes will cause the implementation to raise an {\em Illegal Instruction}
exception.

\subsection{Example Feature Sets}

This section lists some example combinations of feature sets and their
potential use cases.

\begin{enumerate}
\item Base + Randomness + Multi-precision Arithmetic. Such a subset would
    act as a very efficient accelerator to any device performing public
    key cryptography.
\item Base + Scatter/Gather. This subset works as a compact extension to
    a core making use of block ciphers such as AES.
\item Base + All Others. A complete implementation works as a general
    purpose cryptographic instruction set extension. Inclusion of the
    packed arithmetic instructions makes efficient bit-sliced implementations
    easier to express.
\end{enumerate}

It is anticipated that most cores will implement all of the features of the
Crypto ISE, and that only small resource constrained implementations will
pick and choose the ones they need.
